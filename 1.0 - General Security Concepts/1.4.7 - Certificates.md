####  Digital certificates  

• A public key certificate  
– Binds a public key with a digital signature  
– And other details about the key holder  
• A digital signature adds trust  
– PKI uses Certificate Authorities for additional trust  
– Web of Trust adds other users for additional trust  
• Certificate creation can be built into the OS  
– Part of Windows Domain services  
– Many 3rd-party options  
<br>


####  What’s in a digital certificate?  

• X.509  
– Standard format  
• Certificate details  
– Serial number  
– Version  
– Signature Algorithm  
– Issuer  
– Name of the cert holder  
– Public key  
– Extensions  
– And more…  
<br>


####  Root of trust  

• Everything associated with IT security requires trust  
• How to build trust from something unknown?  
– Someone/something trustworthy provides their approval  
• Refer to the root of trust  
– An inherently trusted component  
– Hardware, software, firmware, or other component  
– Hardware security module (HSM), Secure Enclave, Certificate Authority, etc.  
<br>


####  Certificate Authorities  

• Need a good way to trust an unknown entity  
– Use a trusted third-party  
• Certificate Authority (CA) has digitally signed the website certificate  
– You trust the CA, therefore you trust the website  
– Real-time verification  
<br>


####  Third-party certificate authorities  

• Built-in to your browser  
• Purchase your web site certificate  
– It will be trusted by everyone’s browser  
• CA is responsible for vetting the request  
– They will confirm the certificate owner  
– Additional verification information may be required by the CA  
<br>


####  Certificate signing requests  

• Create a key pair, then send the public key to the CA to be signed  
– A certificate signing request (CSR)  
• The CA validates the request  
– Confirms DNS emails and website ownership  
• CA digitally signs the cert  
– Returns to the applicant  
![2024-03-20 16_27_59-professor_messer_sy0_701_comptia_security_plus_course_notes_v106 pdf](https://github.com/0xVoLk/Security-701/assets/100092212/261fefe7-b327-444a-bd2a-e7d0a1222814)  
<br>


####  Private certificate authorities  

• You are your own CA  
– Your devices must trust the internal CA  
• Needed for medium-to-large organizations  
– Many web servers and privacy requirements  
• Implement as part of your overall computing strategy  
– Windows Certificate Services, OpenCA  
<br>


####  Self-signed certificates  

• Internal certificates don’t need to be signed by a public CA  
– Your company is the only one going to use it  
• Build your own CA  
– Issue your own certificates signed by your own CA  
• Install the CA certificate/trusted chain on all devices  
– Works exactly like a certificate you purchased  
<br>


####  Wildcard certificates  

• Subject Alternative Name (SAN)  
– Extension to an X.509 certificate  
– Lists additional identification information  
– Allows a certificate to support many different domains  
• Wildcard domain  
– Certificates are based on the name of the server  
– A wildcard domain will apply to all server names in a domain  
– *.professormesser.com  
<br>


####  Key revocation  

• Certificate Revocation List (CRL)  
– Maintained by the Certificate Authority (CA)  
– Can contain many revocations in a large file  
• Many different reasons  
– Changes all the time  
• April 2014 - CVE-2014-0160  
– Heartbleed  
– OpenSSL flaw put the private key of affected web servers at risk  
– OpenSSL was patched, every web server certificate was replaced  
– Older certificates were moved to the CRL  
<br>


####  OCSP stapling  

• Online Certificate Status Protocol  
– Provides scalability for OCSP checks  
• The CA is responsible for responding to all client OCSP requests  
– This may not scale well  
• Instead, have the certificate holder verify their own status  
– Status information is stored on the certificate holder’s server  
• OCSP status is “stapled” into the SSL/TLS handshake  
– Digitally signed by the CA  
<br>


####  Getting revocation details to the browser  

• OCSP (Online Certificate Status Protocol)  
• Messages usually sent to an OCSP responder via HTTP  
– Easy to support over Internet links  
– Early Internet Explorer versions did not support OCSP
